{"ast":null,"code":"import _regeneratorRuntime from\"/Users/adhamtarek/Desktop/Portofolio Projects/Blog Website (MERN)/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/adhamtarek/Desktop/Portofolio Projects/Blog Website (MERN)/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/adhamtarek/Desktop/Portofolio Projects/Blog Website (MERN)/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useContext,useState}from\"react\";import\"./write.css\";import axios from\"axios\";import{Context}from\"../../context/Context\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Write(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),title=_useState2[0],setTitle=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),desc=_useState4[0],setDesc=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),file=_useState6[0],setFile=_useState6[1];var _useContext=useContext(Context),user=_useContext.user;var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var newPost,data,filename,res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:e.preventDefault();newPost={username:user.username,title:title,desc:desc};if(!file){_context.next=17;break;}data=new FormData();filename=Date.now()+file.name;data.append(\"name\",filename);data.append(\"file\",file);newPost.photo=filename;_context.prev=8;console.log(user.username);_context.next=12;return axios.post(\"/upload\",data);case 12:_context.next=17;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](8);console.log(_context.t0);case 17:_context.prev=17;console.log(user);_context.next=21;return axios.post(\"/posts\",newPost);case 21:res=_context.sent;window.location.replace(\"/post/\"+res.data._id);_context.next=28;break;case 25:_context.prev=25;_context.t1=_context[\"catch\"](17);console.log(_context.t1);case 28:case\"end\":return _context.stop();}},_callee,null,[[8,14],[17,25]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"write\",children:[file&&/*#__PURE__*/_jsx(\"img\",{className:\"writeImg\",src:URL.createObjectURL(file),alt:\"\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"writeForm\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"writeFormGroup\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"fileInput\",children:/*#__PURE__*/_jsx(\"i\",{className:\"writeIcon fas fa-plus\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"fileInput\",style:{display:\"none\"},onChange:function onChange(e){return setFile(e.target.files[0]);}}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Title\",className:\"writeInput\",autoFocus:true,onChange:function onChange(e){return setTitle(e.target.value);}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"writeFormGroup\",children:/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Tell your story...\",type:\"text\",className:\"writeInput writeText\",onChange:function onChange(e){return setDesc(e.target.value);}})}),/*#__PURE__*/_jsx(\"button\",{className:\"writeSubmit\",type:\"submit\",children:\"Publish\"})]})]});}","map":{"version":3,"names":["useContext","useState","axios","Context","jsx","_jsx","jsxs","_jsxs","Write","_useState","_useState2","_slicedToArray","title","setTitle","_useState3","_useState4","desc","setDesc","_useState5","_useState6","file","setFile","_useContext","user","handleSubmit","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","e","newPost","data","filename","res","wrap","_callee$","_context","prev","next","preventDefault","username","FormData","Date","now","name","append","photo","console","log","post","t0","sent","window","location","replace","_id","t1","stop","_x","apply","arguments","className","children","src","URL","createObjectURL","alt","onSubmit","htmlFor","type","id","style","display","onChange","target","files","placeholder","autoFocus","value"],"sources":["/Users/adhamtarek/Desktop/Portofolio Projects/Blog Website (MERN)/client/src/pages/write/Write.jsx"],"sourcesContent":["import { useContext, useState } from \"react\";\nimport \"./write.css\";\nimport axios from \"axios\";\nimport { Context } from \"../../context/Context\";\n\nexport default function Write() {\n  const [title, setTitle] = useState(\"\");\n  const [desc, setDesc] = useState(\"\");\n  const [file, setFile] = useState(null);\n  const { user } = useContext(Context);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    const newPost = {\n      username: user.username,\n      title,\n      desc,\n    };\n    if (file) {\n      const data = new FormData();\n      const filename = Date.now() + file.name;\n      data.append(\"name\", filename);\n      data.append(\"file\", file);\n      newPost.photo = filename;\n      try {\n        console.log(user.username);\n        await axios.post(\"/upload\", data);\n      } catch (err) {\n        console.log(err);\n      }\n    }\n    try {\n      console.log(user);\n      const res = await axios.post(\"/posts\", newPost);\n      window.location.replace(\"/post/\" + res.data._id);\n    } catch (err) {\n      console.log(err);\n    }\n  };\n  return (\n    <div className=\"write\">\n      {file && (\n        <img className=\"writeImg\" src={URL.createObjectURL(file)} alt=\"\" />\n      )}\n      <form className=\"writeForm\" onSubmit={handleSubmit}>\n        <div className=\"writeFormGroup\">\n          <label htmlFor=\"fileInput\">\n            <i className=\"writeIcon fas fa-plus\"></i>\n          </label>\n          <input\n            type=\"file\"\n            id=\"fileInput\"\n            style={{ display: \"none\" }}\n            onChange={(e) => setFile(e.target.files[0])}\n          />\n          <input\n            type=\"text\"\n            placeholder=\"Title\"\n            className=\"writeInput\"\n            autoFocus={true}\n            onChange={(e) => setTitle(e.target.value)}\n          />\n        </div>\n        <div className=\"writeFormGroup\">\n          <textarea\n            placeholder=\"Tell your story...\"\n            type=\"text\"\n            className=\"writeInput writeText\"\n            onChange={(e) => setDesc(e.target.value)}\n          ></textarea>\n        </div>\n        <button className=\"writeSubmit\" type=\"submit\">\n          Publish\n        </button>\n      </form>\n    </div>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}